module.exports=[45761,a=>{a.v({card:"page-module___eeNZa__card",checkmark:"page-module___eeNZa__checkmark",errorTitle:"page-module___eeNZa__errorTitle",icon:"page-module___eeNZa__icon",page:"page-module___eeNZa__page",spin:"page-module___eeNZa__spin",spinner:"page-module___eeNZa__spinner",success:"page-module___eeNZa__success"})},92010,a=>{"use strict";var b=a.i(22642),c=a.i(365),d=a.i(89983),e=a.i(83908),f=a.i(45761);function g(){let a=(0,c.useSearchParams)().get("redirect"),[g,h]=(0,d.useState)("loading"),[i,j]=(0,d.useState)(null);return(0,d.useEffect)(()=>{(async()=>{let b=(0,e.createClient)(),{data:{session:c}}=await b.auth.getSession();if(c)try{let b=await fetch("/api/auth/cli-token",{method:"POST",headers:{"Content-Type":"application/json"}});if(b.ok){let{token:c}=await b.json();a?window.location.href=`${a}?token=${c}`:h("success")}else throw Error("Failed to generate token")}catch{j("Failed to generate CLI token"),h("error")}else{h("authenticating");let{error:c}=await b.auth.signInWithOAuth({provider:"github",options:{redirectTo:`${window.location.origin}/auth/cli/callback${a?`?redirect=${encodeURIComponent(a)}`:""}`}});c&&(j(c.message),h("error"))}})()},[a]),(0,b.jsxs)("div",{className:f.default.card,children:[(0,b.jsx)("span",{className:f.default.icon,children:"ðŸ”"}),"loading"===g&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("h1",{children:"Authenticating CLI..."}),(0,b.jsx)("p",{children:"Please wait while we verify your credentials."}),(0,b.jsx)("div",{className:f.default.spinner})]}),"authenticating"===g&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("h1",{children:"Redirecting to GitHub..."}),(0,b.jsx)("p",{children:"You'll be redirected to GitHub to authenticate."}),(0,b.jsx)("div",{className:f.default.spinner})]}),"success"===g&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("h1",{className:f.default.success,children:"Authentication Successful!"}),(0,b.jsx)("p",{children:"You can now close this window and return to your terminal."}),(0,b.jsx)("div",{className:f.default.checkmark,children:"âœ“"})]}),"error"===g&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("h1",{className:f.default.errorTitle,children:"Authentication Failed"}),(0,b.jsx)("p",{children:i||"An unexpected error occurred."}),(0,b.jsx)("button",{onClick:()=>window.location.reload(),className:"btn btn-primary",children:"Try Again"})]})]})}function h(){return(0,b.jsxs)("div",{className:f.default.card,children:[(0,b.jsx)("span",{className:f.default.icon,children:"ðŸ”"}),(0,b.jsx)("h1",{children:"Loading..."}),(0,b.jsx)("div",{className:f.default.spinner})]})}function i(){return(0,b.jsx)("div",{className:f.default.page,children:(0,b.jsx)(d.Suspense,{fallback:(0,b.jsx)(h,{}),children:(0,b.jsx)(g,{})})})}a.s(["default",()=>i])}];

//# sourceMappingURL=apps_market_src_app_auth_cli_68ca8da8._.js.map